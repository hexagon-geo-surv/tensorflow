syntax = "proto3";

package xla.gpu;

import "xla/service/shaped_slice.proto";
import "xla/xla_data.proto";

option java_outer_classname = "CollectiveThunk";

message CollectiveBufferProto {
  int64 element_count = 1;
  xla.ShapedSliceProto source_buffer = 2;
  xla.ShapedSliceProto destination_buffer = 3;
  int64 source_memory_space = 4;
  int64 destination_memory_space = 5;
}

message CollectiveConfigProto {
  repeated xla.PrimitiveType operand_element_type = 1;
  repeated xla.ReplicaGroup replica_groups = 2;
  xla.CollectiveOpGroupMode group_mode = 3;
  bool use_symmetric_buffer = 4;
}

message P2PConfigProto {
  message SourceTargetMapEntry {
    optional int64 source = 1;
    optional int64 target = 2;
  }

  CollectiveConfigProto config = 1;
  map<int64, SourceTargetMapEntry> id_to_source_target = 2;
}
