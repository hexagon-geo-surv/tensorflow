// RUN: hlo-opt %s --platform=gpu --stage=hlo --xla_gpu_target_config_filename=%S/../../../tools/hlo_opt/gpu_specs/v100.txtpb --split-input-file | FileCheck %s --check-prefixes=CHECK-SM70
// RUN: hlo-opt %s --platform=gpu --stage=hlo --xla_gpu_target_config_filename=%S/../../../tools/hlo_opt/gpu_specs/a100_80.txtpb --split-input-file --xla_gpu_autotune_level=0 --xla_gpu_enable_triton_gemm=false | FileCheck %s --check-prefixes=CHECK-SM80


// CHECK-SM70: custom-call(f32
// CHECK-SM80: custom-call(bf16

HloModule module

ENTRY %computation1 {
    a = s8[1536,6144] parameter(0)
    c = bf16[1536,6144] convert(a)
    b = bf16[32,1536] parameter(1)
    ROOT out = dot(a, b), lhs_contracting_dims={0}, rhs_contracting_dims={1}
}


